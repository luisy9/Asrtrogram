---
import Layout from "../layouts/Layout.astro";
import Index from "../pages/index.astro";
import Picture from "./Picture.astro";

const url = "http://localhost:3000/api";

let imagesUser = [];

const token = Astro.cookies.get("token").value;

try {
  const images = await fetch(`${url}/allimages`, {
    method: "GET",
    headers: {
      Authorization: `Bearer ${token}`,
    },
  });

  imagesUser = await images.json();
} catch (error) {
  console.log(error);
}
---

<Index title="feed" slot="index">
  <div class="" slot="index">
    <div class="flex flex-col gap-4 h-screen bg-sky-400">
      <h1>hol</h1>
      {imagesUser?.map((image) => <Picture image={image} />)}
    </div>
  </div>
</Index>
